## PokerImage接口交互文档

**Version 1.0**

# 0 规范介绍

本文档对PokerImage交互接口进行定义，包括接口定义，请求参数、响应结果和错误码定义。

# 1 函数说明

## 1.1 PokerImageProcess

### 1.1.1 概述

* 此函数是一个混合开发接口通信函数，是各个流程的通用接口函数。
* 此函数有一个 json 字符串（req_info），两个回调（on_start 和 on_callback）共计三个参数。
* req_info 为各个流程需传入的相关业务字段，其中 operation 为各个流程的必传字段，operation 字段区分各种流程。
* on_start 是为了避免前端和dll两种语言（javascript 和 C/C++）的桥接限制导致潜在的资源泄露及野对象或空对象问题而引入的同步回调，起到返回值的作用。
* on_callback 是合并了 OnNext 和 OnComplete 两种事件数据流推送的异步回调

#### 1.1.1.1 函数原型

```cpp
  void PokerImageProcess(const char* req_info, OnStartFunc on_start,
                            OnCallbackFunc on_callback)
```

#### 1.1.1.2 参数列表

| **字段名称** | **类型** | **描述**             | **备注** |
| ------------------ | -------------- | -------------------------- | -------------- |
| req_info       | char*          | 传入业务信息的 json 字符串 |                |
| on_start           | char*          | Start 同步回调             |                |
| on_callback        | char*          | callback 异步回调          |                |

### 1.1.1.3 req_info 必传字段

| **字段名称** | **类型** | **是否必传** | **描述** |
| ------------------ | -------------- | ------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| operation          | string         | Y                  | 以下值之一："generate" |


### 2.generate -- 生成扑克牌组图片
#### 2.1 generate-req_info 请求参数

| **字段名称** | **类型** | **是否必传** | **描述**                                                          | **备注** |
| ------------------ | -------------- | ------------------ | ----------------------------------------------------------------------- | -------------- |
| operation          | string         | Y                  | 以下值："generate"                                                      |                |
| output | string | Y | 文件保存目录，"/"结尾 |
| cards | array | Y | 牌组信息 |

#### req_info - cards 字段说明

```json
"cards":[
  {
    "number": 1,  // 牌号, 1-15 A-1,J-11,Q-12,K-13,littlejoker-14,bigjoker-15
    "hide": false,  // 牌面是否显示背面
    "suit": "heart"  // 花色 spade-黑桃 heart-红桃 club-梅花 diamond-方片
  },
  ...  // 其他一样
]
```

### 1.1.2.1.2 Cloud189-DoUpload/DoDirectUpload-on_start

* 此处回调为传给 JS 侧的信息

| **字段名称** | **类型** | **是否必传** | **描述**                              | **备注**                                      |
| ------------------ | -------------- | ------------------ | ------------------------------------------- | --------------------------------------------------- |
| operation          | string         | Y                  | 与 req_info 传入的一致，以下值："generate" |                                                     |
| start_result       | int32          | Y                  | 指定的创建流程是否成功                      | 0：成功   非 0：失败 |

### 1.1.2.1.3 Cloud189-DoUpload/DoDirectUpload-on_callback

* 此处回调为传给 JS 侧的信息

| **字段名称** | **类型** | **是否必传** | **描述**                                                                                                               | **备注**                                                                                                                                                   |
| ------------------ | -------------- | ------------------ | ---------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| operation          | string         | Y                  | 与 req_info 传入的一致，以下值："generate"                                                                                                        |                                                                                                                                                                  |
| file_name          | string         | Y                  | 生成的文件名                                                                                                        |                                                                                                                                                                  |
| is_exist          | bool         | Y                  | 文件是否已经存在                                                                                                        |                                                                                                                                                                  |
